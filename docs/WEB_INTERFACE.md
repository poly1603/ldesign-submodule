# Web管理界面使用指南

## 概述

Git Submodule Manager 提供了一个现代化的Web管理界面，让您可以通过浏览器轻松管理Git子模块。

## 启动Web服务器

### 基本使用

```bash
# 使用默认设置启动（localhost:3000）
lsm serve

# 指定端口
lsm serve -p 8080

# 指定主机和端口
lsm serve -h 0.0.0.0 -p 8080

# 自动打开浏览器
lsm serve --open

# 以只读模式启动
lsm serve --readonly
```

### 命令选项

- `-p, --port <port>` - 端口号（默认: 3000）
- `-h, --host <host>` - 主机地址（默认: localhost）
- `--open` - 自动在浏览器中打开
- `--readonly` - 以只读模式启动（禁用所有写操作）

## 功能特性

### 1. 子模块列表

- 查看所有子模块的状态
- 实时显示提交哈希、分支、同步状态
- 状态指示器：
  - ✅ **最新** - 子模块是最新的
  - ⚠️ **已修改** - 有未提交的更改
  - ❌ **未初始化** - 子模块未初始化
  - 🔄 **合并冲突** - 存在合并冲突

### 2. 添加子模块

1. 点击"➕ 添加子模块"按钮
2. 填写必要信息：
   - **仓库URL**（必填）：Git仓库的URL
   - **路径**（必填）：子模块在项目中的路径
   - **分支**（可选）：指定分支
3. 可选"强制添加"覆盖已存在的子模块
4. 点击"添加"完成

### 3. 更新子模块

#### 单个更新
- 在子模块列表中点击"更新"按钮
- 系统会自动拉取最新更改

#### 批量更新
- 点击"⬆️ 更新全部"按钮
- 确认后更新所有子模块

### 4. 删除子模块

1. 在子模块列表中找到要删除的子模块
2. 点击"删除"按钮
3. 确认删除操作

### 5. 同步子模块

点击"🔄 同步"按钮可以：
- 同步所有子模块的URL
- 更新.gitmodules配置

### 6. 分析功能

点击"📊 分析"按钮查看：
- 子模块总数统计
- 状态分布（最新/已修改/未初始化等）
- 冲突检测
- 循环依赖检测
- 未使用的子模块

### 7. 健康检查

点击"🏥 健康检查"按钮进行：
- 配置文件验证
- URL可达性检查
- 未提交更改检查
- 版本一致性检查
- 整体健康评分

### 8. 子模块详情

点击"详情"按钮查看：
- 完整的子模块信息
- URL和路径
- 当前提交和分支
- 与远程的差异（领先/落后的提交数）
- 未提交更改警告

## 界面布局

### 统计面板
显示快速概览：
- 总计：子模块总数
- 最新：最新状态的子模块数
- 已修改：有修改的子模块数
- 未初始化：未初始化的子模块数

### 操作面板
快速访问常用操作：
- 添加子模块
- 更新全部
- 同步
- 分析
- 健康检查

### 子模块列表
详细列出所有子模块及其状态

## 只读模式

在只读模式下：
- 禁用所有写操作（添加、删除、更新等）
- 保留所有查看和分析功能
- 适合在生产环境或共享访问时使用

```bash
lsm serve --readonly
```

## 快捷键

- `Ctrl+R` / `F5` - 刷新子模块列表
- `Esc` - 关闭当前打开的模态框

## 故障排除

### 端口已被占用

```bash
# 使用其他端口
lsm serve -p 3001
```

### 无法连接到服务器

1. 检查防火墙设置
2. 确认端口没有被其他程序占用
3. 尝试使用`0.0.0.0`作为主机地址

```bash
lsm serve -h 0.0.0.0 -p 3000
```

### 操作失败

1. 检查Git仓库状态
2. 确保有足够的权限
3. 查看浏览器控制台的错误信息
4. 检查服务器终端的日志输出

## 安全建议

1. **生产环境使用只读模式**
   ```bash
   lsm serve --readonly -h 0.0.0.0
   ```

2. **限制访问范围**
   - 默认只监听localhost
   - 如需远程访问，考虑使用反向代理（如nginx）
   - 配置防火墙规则

3. **使用HTTPS**
   - 通过反向代理添加SSL/TLS加密
   - 保护敏感数据传输

## API端点

Web界面基于RESTful API构建，您也可以直接使用这些API：

### 获取子模块列表
```
GET /api/submodules?verbose=true
```

### 获取子模块状态
```
GET /api/submodules/status
```

### 添加子模块
```
POST /api/submodules
Content-Type: application/json

{
  "url": "https://github.com/user/repo.git",
  "path": "path/to/submodule",
  "branch": "main"
}
```

### 删除子模块
```
DELETE /api/submodules/{path}
```

### 更新子模块
```
PUT /api/submodules/{path}/update
```

### 分析
```
GET /api/analyze
```

### 健康检查
```
GET /api/health
```

更多API详情请参考API文档。

## 性能优化

### 大型项目

对于包含大量子模块的项目：
1. 使用过滤器减少加载的数据
2. 考虑分批更新而不是全部更新
3. 定期清理未使用的子模块

### 网络优化

- 使用`--jobs`参数并行处理
- 配置合理的超时时间
- 使用本地镜像加速

## 下一步

- 查看[命令行界面文档](../QUICK_START.md)
- 了解[架构设计](../ARCHITECTURE.md)
- 阅读[API参考文档](./API.md)